// @require JsMethod > localClass
// @require JsMethod > objectToArray
// @require JsMethod > urlQueryParse
// @require JsMethod > urlQueryBuild
(function(f){f.wjs.classExtend("WjsWebCompLocalClass",{init:function(){return!0},exit:function(){return!0},webCompRemove:function(){this.dom.parentNode.removeChild(this.dom)}});f.wjs.loaderAdd("WebComp",{shortcutName:"webComp",webCompLocalClasses:{},__construct:function(){var b,a=this.wjs.urlQueryParse();this.regLink=/^wjs:\/\/([a-zA-Z0-9]*):([a-zA-Z0-9]*)$/;this.wjs[this.shortcutName+"Ready"]=this.webCompReady.bind(this);this.wjs[this.shortcutName+"LocalClass"]=this.webCompLocalClass.bind(this);
this.readyCallbacks={};this.wjs.classMethods.WjsLoader.__construct.apply(this,arguments);if(a[this.type])for(b=0;b<a[this.type].length;b++)this.query(a[this.type][b])},__destruct:function(){delete this.wjs[this.shortcutName+"Ready"];delete this.wjs[this.shortcutName+"LocalClass"];delete this.wjs.classMethods.WjsWebCompLocalClass},parse:function(b,a,c){a.dom=this.wjs.document.createElement("div");a.dom.innerHTML=a.html;a.dom.setAttribute("id",this.type+"-"+b);if(a.destination){a.domDestination=this.wjs.window.document.querySelector(a.destination);
a.domDestination.appendChild(a.dom);var d,e=a.domDestination.querySelectorAll("*[href]");for(c=0;c<e.length;c++)e[c].hasAttribute("href")&&(d=e[c].getAttribute("href"),d.match(this.regLink)&&(e[c].setAttribute("href","javascript:void(0);"),e[c].setAttribute("data-wjs-link",d),e[c].addEventListener("click",this.listenCallbackClick.bind(this))))}a.urlUpdate&&(c=this.wjs.urlQueryParse(),c[this.type]||(c[this.type]=[]),-1===c[this.type].indexOf(b)&&c[this.type].push(b),this.wjs.window.history.replaceState(null,
null,"?"+this.wjs.urlQueryBuild(c)));this.webCompLocalClasses[b]&&this.webCompLocalClasses[b].init&&(this.wjs.extendObject(this.webCompLocalClasses[b],a),this.webCompLocalClasses[b].init(a));return a},listenCallbackClick:function(b){var a=b.target.getAttribute("data-wjs-link").match(this.regLink);this.wjs.loaders[a[1]]?this.wjs.loaders[a[1]].link(a[2],b):this.wjs.use(a[1],a[2])},destroy:function(b,a,c){var d=!0;this.webCompLocalClasses[b]&&this.webCompLocalClasses[b].exit&&(d=this.webCompLocalClasses[b].exit(a,
c));d&&a.dom.parentNode.removeChild(a.dom);if(a.urlUpdate&&(a=this.wjs.urlQueryParse(),a[this.type])){for(c=a[this.type].indexOf(b);-1!==c;)a[this.type].splice(c,1),c=a[this.type].indexOf(b);this.wjs.window.history.replaceState(null,null,"?"+this.wjs.urlQueryBuild(a))}return d},webCompReady:function(b,a){this.readyCallbacks[b]=a.bind(wjs)},webCompLocalClass:function(b,a){a.classExtends=a.classExtends||"WjsWebCompLocalClass";this.webCompLocalClasses[b]=this.wjs.localClass("WjsWebCompLocalClass"+b,
a)}})})(wjsContext);