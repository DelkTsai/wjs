// @require Element > D3WebCom
// @require JsClass > ThreeCamera
// @require JsMethod > arrayDeleteItem
(function(c){c.register("Element","D3World",{classExtends:"Element\\D3WebCom",variables:{perspective:1E3,cameraWorldPosition:0,child3dSort:[]},optionsDefault:{global:!0,dom:!0},init3D:function(){this.__super("init3D",arguments);this.camera=new (this.wjs.classProto("ThreeCamera"))(0,1,0);this.camera.translateZ(-1E3);this.camera.updateMatrix()},render:function(){this.cameraWorldPosition=this.camera.getWorldPosition();this.__super("render",arguments);this.renderSortZ()},renderSortZ:function(){for(var a=
0,b,c=this.child3dSort.sort(this.renderSortZCompare);b=c[a++];)b.dom.style.zIndex=a},renderSortZCompare:function(a,b){return a.distanceToCamera>b.distanceToCamera?1:a.distanceToCamera<b.distanceToCamera?-1:0},globalChildAppend:function(a){a.D3World=this;a.object3d.parent=this.object3d;this.child3dSort.push(a)},globalChildRemove:function(a){this.wjs.arrayDeleteItem(this.child3dSort,a)},renderDom:function(a){this.object3d.updateMatrixWorld();this.dom.style.perspective=this.perspective+"px";this.__super("renderDom",
arguments)}})})(WjsProto);