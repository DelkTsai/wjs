(function(n){n.register("JsClassStatic","lazyTagsLoad",{destinationRoutes:[],destinationActivated:{},destinationOriginalHtml:{},typesCounter:{},screenWidth:0,screenHeight:0,processing:!1,__construct:function(){var a=this.wjs.window,b=this.onScreenChange.bind(this);wjs.lazyTagsLoader=this;this.tagsDetect(this.wjs.document);this.tagsVisibleActivateAll();a.addEventListener("scroll",b);a.addEventListener("resize",b)},onScreenChange:function(){this.tagsVisibleActivateAll()},tagsDetect:function(a){var b=
0;for(a=a.querySelectorAll("[data-wjs]");b<a.length;b++)-1===this.destinationRoutes.indexOf(a[b])&&this.destinationRoutes.push(a[b])},tagsVisibleActivateAll:function(){for(var a=0,b=[],c=this.wjs,e,d,f,g,h,k={},l=c.window.pageYOffset||c.document.documentElement.scrollTop,m=c.window.pageXOffset||c.document.documentElement.scrollLeft;a<this.destinationRoutes.length;a++)g=this.destinationRoutes[a],f=g.getBoundingClientRect(),h=this.destinationActivated[a],d=this.tagType(g),e=d.type,d=d.name,f.top+l<
c.window.innerHeight+l&&f.top+f.height+l>l&&f.left+m<c.window.innerWidth+m&&f.left+f.width+m>m?h||((f=c.get(e,d))?this.tagFill(e,d,g,f):(b[e]=b[e]||{},b[e][d]=b[e][d]||[],b[e][d].push(g),k[e]=k[e]||[],-1===k[e].indexOf(d)&&k[e].push(d))):h&&this.tagEmpty(e,d,g);c.use(k,{destination:!1,lazyVisible:b,complete:this.useComplete.bind(this)})},tagType:function(a){a=a.getAttribute("data-wjs").split(":");return{type:a[0],name:a[1]}},tagFill:function(a,b,c,e){var d=this.typesCounter,f=this.destinationRoutes,
g=this.destinationActivated,h=f.indexOf(c);g[h]||(g[h]=c,this.destinationOriginalHtml[f.indexOf(c)]=c.innerHTML,c.appendChild(e.dom.cloneNode(!0)),d[a]=d[a]||{},d[a][b]=d[a][b]||0,d[a][b]++)},tagEmpty:function(a,b,c){var e=this.destinationActivated,d=this.destinationOriginalHtml,f=this.destinationRoutes.indexOf(c);if(e[f]){for(;c.firstChild;)c.removeChild(c.firstChild);c.innerHTML=d[f];delete e[f];delete d[f];this.typesCounter[a][b]--;0===this.typesCounter[a][b]&&this.wjs.settings.lazyTagsLoadAutoDestroy&&
(this.wjs.destroy(a,b,!0),delete this.typesCounter[a][b],this.wjs.objectIsEmpty(this.typesCounter[a])&&delete this.typesCounter[a])}},useComplete:function(a,b){for(var c=0,e,d,f=Object.keys(b.options.lazyVisible),g,h;c<f.length;c++)for(g=Object.keys(b.options.lazyVisible[f[c]]),e=0;e<g.length;e++)for(h=b.options.lazyVisible[f[c]][g[e]],d=0;d<h.length;d++)this.tagFill(f[c],g[e],h[d],a[f[c]][g[e]])}})})(WjsProto);