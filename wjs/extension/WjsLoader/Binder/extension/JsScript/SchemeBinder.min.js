// @require JsScript > SchemeWebCom
// @require JsMethod > inheritMethod
// @require JsMethod > inheritLinage
// @require JsMethod > arrayDeleteItem
(function(f){f.register("WebComScheme","SchemeBinder",{classExtends:"WebCom",type:"Binder",variables:{cssClasses:null,listeners:{},statesVars:{},stateConnected:{},stateListener:{}},states:{},options:{cssClasses:{define:function(a,b){b=b||[];a.loader.classLists[a.typeGlobal]&&(a.cssClasses=b.concat(a.loader.classLists[a.typeGlobal]))}}},__construct:function(a){this.__super("__construct",arguments);this.wjs.inheritLinage(this,"callbacks");this.wjs.inheritLinage(this,"states");for(var b in this)0===
b.indexOf("__callbacks__domListen__")&&(this[b]=this[b].bind(this))},cssRulesClassInit:function(){var a=this.wjs.inheritMethod(this,"cssRulesClassInit",arguments),b=0,c;c=this.loader.protoName(this.type);var d=this.loader.domStyle[c];if(d)for(;c=this.loader.classLists[this.typeGlobal][b++];)this.cssRulesClassSearch(d.sheet,c)&&(a=!0);return a},callbackFind:function(a,b){return"function"===typeof a?a:this.method("callbacks."+b+"."+a)},domChildFill:function(a,b){this.wjs.inheritMethod(this,"domChildFill",
arguments);this.trigger("domChildFill",[a,b])},domChildRemove:function(a){a=this.domChildGet(a);a.parentNode.removeChild(a)},domStyleGet:function(a){return this.wjs.window.getComputedStyle(this.dom,null).getPropertyValue(a)},domRect:function(){return this.dom.getBoundingClientRect()},stateSet:function(a,b,c){var d=this.states[a],e;if(b!==d){this.states.hasOwnProperty(a)||this.error("Trying to set undefined state "+a);e=this.callbackFind(a,"stateSet");this.states[a]=b;this.statesVars[a]=this.statesVars[a]||
{};this.wjs.extendObject(this.statesVars[a],c||{});if(e)this[this.methodName("callbacks.stateSet."+a)](b,c,d);this.trigger("stateSet",[a,b,d])}},stateGet:function(a){return this.states[a]},stateIs:function(a,b){"string"===typeof a&&(a={},a[a]=b);for(var c=0,d,e=Object.keys(a);d=e[c++];)if(this.states[d]!==a[d])return!1;return!0},stateListen:function(a,b,c,d){c=this.callbackFind(c,"stateListen");this.stateListener[a.id]=this.stateListener[a.id]||{};this.stateListener[a.id][b]=c;1===Object.keys(this.stateListener[a.id]).length&&
this.listen(a,"stateSet","stateListen");d&&c.apply(this,[a,b,a.stateGet(b)])},stateForget:function(a,b,c,d){var e=this.stateListener[a.id];c=this.callbackFind(c,"stateListen");d&&this.callbackFind(c,"stateListen").apply(this,[a,b,a.stateGet(b)]);delete e[b];0===Object.keys(e).length&&this.forget(a,"stateSet")},stateConnect:function(a,b,c,d){var e=this.stateConnected;e[a.id]=e[a.id]||{};e[a.id][b]=e[a.id][b]||[];e[a.id][b].push(c);this.stateListen(a,b,this.callbackFind("stateConnect","stateListen"),
d)},stateDisconnect:function(a,b,c,d){var e=this.stateConnected;if(e=e[a.id]?e[a.id][b]:void 0)this.wjs.arrayDeleteItem(e,c),this.stateForget(a,b,this.callbackFind("stateConnect","stateListen"),d)},listen:function(a,b,c){c=this.callbackFind(c,"listen");return!!a.listenerAdd(b,this,c)},forget:function(a,b){return!!a.listenerRemove(b,this)},hasListener:function(a,b){return this.listeners[a]&&this.listeners[a][b.id]},listenerAdd:function(a,b,c){return this.hasListener(a,b)?!1:(this.listeners[a]=this.listeners[a]||
{},this.listeners[a][b.id]=c,!0)},listenerRemove:function(a,b){this.hasListener(a,b)&&(delete this.listeners[a][b.id],0===Object.keys(this.listeners[a]).length&&delete this.listeners[a])},trigger:function(a,b){var c={},d=0,e,h=this.listeners[a]||{},g,f=Object.keys(h);b=b||[];for(b.unshift(this);g=f[d++];)(e=this.wjs.loaders.WebCom.webComList[g])&&(c[e.id]=h[g].apply(e,b));return c},domListen:function(a,b,c){this.domNodeListMap("domListen",arguments)||a.addEventListener(b,"function"===typeof c?c:this[this.methodName("callbacks.domListen."+
c)])},domForget:function(a,b,c){this.domNodeListMap("domForget",arguments)||a.removeEventListener(b,"function"===typeof c?c:this[this.methodName("callbacks.domListen."+c)])},domNodeListMap:function(a,b){var c=this,d;return b[0]instanceof c.wjs.window.NodeList?(d=c.wjs.extendObject([],b),Array.prototype.slice.call(b[0]).map(function(b){d[0]=b;c[a].apply(c,d)},this),!0):!1},callbacks:{listen:{stateListen:function(a,b,c,d){var e=this.stateListener[a.id]?this.stateListener[a.id][b]:void 0;e&&e.apply(this,
[a,b,c,d])}},stateListen:{stateConnect:function(a,b,c){a=this.stateConnected[a.id]?this.stateConnected[a.id][b]:void 0;b=0;var d,e;if(a)for(d=Object.keys(a);e=d[b++];)this.stateSet(a[e],c)}}}})})(WjsProto);