// @require WjsLoader > WebComp
// @require JsClass > BasicBinder
(function(l){l.register("WjsLoader","Binder",{loaderExtends:"WebComp",protoBaseClass:"BasicBinder",__construct:function(){this.wjs.extendObject(this,{domStyle:{},domStyleAll:{},classSaved:{},classLists:{},cssClassCounter:0,cssDomItems:{},cssRewritten:{},regReplaceSlashes:/\./g});this.wjs.loaders.WebComp.__construct.call(this)},cssInit:function(a,d){this.cssDomInit(a,d);return this.cssClassInit(a,d)},cssDomInit:function(a,d){var b=0,c;for(c=this.wjs.inheritProperty(a,"type");b<c.length;b++)this.cssDomInitType(c[b],
d)},cssDomInitType:function(a,d){var b=this.wjs.get(this.type,a),c=this.domStyle;d?(this.cssDomItems[a]=this.cssDomItems[a]||0,this.cssDomItems[a]++,b&&b.css&&!c[a]&&(c[a]=this.wjs.document.createElement("style"),c[a].innerHTML=b.css.replace(/(url\(["'])(?!http[s]*:\/\/)/g,"$1"+b.client),this.wjs.document.head.appendChild(c[a]))):(this.cssDomItems[a]--,0===this.cssDomItems[a]&&c[a]&&(c[a].parentNode.removeChild(c[a]),delete c[a]))},cssClassInit:function(a,d){var b=0,c=!1,f,e,h,k=[],g=a.typeGlobal;
for(h=this.wjs.inheritProperty(a,"type");b<h.length;b++)k.push(h[b]),"Binder"===h[b]&&(c=!0),c&&(f=h[b].replace(this.regReplaceSlashes,"_"),e=k.join("-"),d?(this.cssClassAdd(e,g),this.cssRewriteAll(f,this.classSaved[e]),this.cssRewritten[e]=this.cssRewritten[e]||0,this.cssRewritten[e]++,-1===this.classLists[g].indexOf(this.classSaved[e])&&this.classLists[g].push(this.classSaved[e])):(this.cssRewritten[e]--,0===this.cssRewritten[e]&&(this.cssRewriteAll(this.classSaved[e],f),this.cssClassRemove(e,g))));
a.classGlobal=this.classSaved[g];return this.classLists[g]},cssClassAdd:function(a,d){var b=this.classSaved,c=this.classLists;b[a]||(b[a]="c"+this.cssClassCounter++);c[d]=c[d]||[]},cssClassRemove:function(a,d){var b=this.classLists;this.classSaved[a]&&delete this.classSaved[a];b[d]&&delete b[d]},cssRewriteAll:function(a,d){for(var b=0,c=this.domStyle,f=Object.keys(c);b<f.length;b++)this.cssRewrite(a,d,c[f[b]])},cssRewrite:function(a,d,b){b.innerHTML=b.innerHTML.replace(RegExp("\\."+a+"(?=[\\s*|{|,|.|-|:])",
"g"),"."+d)}})})(WjsProto);