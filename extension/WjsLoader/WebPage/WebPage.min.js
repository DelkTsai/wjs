// @require JsClass > BasicWebPage
// @require JsMethod > extEnable
// @require JsMethod > extDisable
(function(h){h.register("WjsLoader","WebPage",{loaderExtends:"WebComp",protoBaseClass:"BasicWebPage",pageCurrent:null,destroyDelay:5E3,__construct:function(){this.destroyTimeouts={};this.wjs.loaders.WebComp.__construct.call(this)},link:function(a){this.pageShow(a)},parse:function(a,b,c){return this.wjs.loaders.WebComp.parse.apply(this,arguments)},enable:function(a,b,c){c&&c.options.webPagePreload||this.instance(a,b)},instance:function(a,b){return this.pageCurrent=this.wjs.loaders.WebComp.instance.apply(this,
arguments)},pageChange:function(a){this.pageCurrent[a]&&this.pageHide(this.pageCurrent[a])},pageShow:function(a){var b=this.wjs;this.pageCurrent?this.pageHide(a):(this.destroyTimeouts[a]&&this.wjs.window.clearTimeout(this.destroyTimeouts[a]),b.get(this.type,a)?b.extEnable(this.type,a):b.use(this.type,a))},pageHide:function(a){if(!this.pageHideStarted){var b=this,c=b.pageCurrent,e=!1,f=!1,g=function(){if(e&&f){var d=b.pageCurrent;d.loader.destroyTimeout(d.type);b.wjs.extDisable(d.loader.type,d.type);
b.pageCurrent=!1;b.pageHideStarted=!1;b.pageShow(a)}};b.pageHideStarted=!0;b.wjs.use(this.type,a,{webPagePreload:!0,complete:function(a){e=!0;log(a);g()}});c.exit(function(){f=!0;g()})}},destroyTimeout:function(a){var b=this;this.destroyTimeouts[a]=this.wjs.window.setTimeout(function(){b.wjs.destroy(b.type,a,{dependencies:!0});delete b.destroyTimeouts[a]},this.destroyDelay)}})})(WjsProto);